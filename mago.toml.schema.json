{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/kgz/mago_vscode/main/mago.toml.schema.json",
  "title": "Mago Configuration Schema",
  "description": "Schema for mago.toml configuration files used by the Mago static analysis tool",
  "type": "object",
  "properties": {
    "php-version": {
      "type": "string",
      "description": "The version of PHP to use for parsing and analysis",
      "pattern": "^\\d+\\.\\d+$",
      "examples": ["8.1", "8.2", "8.3", "8.4"],
      "default": "8.1"
    },
    "allow-unsupported-php-version": {
      "type": "boolean",
      "description": "Allow Mago to run on unsupported PHP versions. Not recommended",
      "default": false
    },
    "threads": {
      "type": "integer",
      "description": "The number of threads to use for parallel tasks",
      "minimum": 1,
      "default": "logical CPUs"
    },
    "stack-size": {
      "type": "integer",
      "description": "The stack size in bytes for each thread. Defaults to 2MB, with a minimum of 2MB and a maximum of 8MB",
      "minimum": 2097152,
      "maximum": 8388608,
      "default": 2097152
    },
    "use-pager": {
      "type": "boolean",
      "description": "Use a pager for long output",
      "default": false
    },
    "pager": {
      "type": "string",
      "description": "The pager command to use (e.g., 'less -R')",
      "default": null
    },
    "source": {
      "type": "object",
      "description": "Configuration for how Mago discovers files to analyze and format",
      "properties": {
        "paths": {
          "type": "array",
          "description": "A list of directories to scan for source files. If empty, the entire workspace is scanned",
          "items": {
            "type": "string"
          },
          "default": []
        },
        "includes": {
          "type": "array",
          "description": "A list of specific files or directories to include for analysis context (e.g., vendor packages). These files will not be formatted, linted, or analyzed directly, but they provide essential context for the analyzer to understand symbols and types from third-party code",
          "items": {
            "type": "string"
          },
          "default": []
        },
        "excludes": {
          "type": "array",
          "description": "A list of paths or glob patterns to exclude from scanning",
          "items": {
            "type": "string"
          },
          "default": []
        },
        "extensions": {
          "type": "array",
          "description": "A list of file extensions to consider as PHP files",
          "items": {
            "type": "string"
          },
          "default": ["php"]
        }
      }
    },
    "linter": {
      "type": "object",
      "description": "Linter configuration options",
      "additionalProperties": true
    },
    "formatter": {
      "type": "object",
      "description": "Formatter configuration options",
      "additionalProperties": true
    },
    "analyzer": {
      "type": "object",
      "description": "Analyzer configuration options",
      "additionalProperties": true
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "php-version": "8.4",
      "threads": 8,
      "stack-size": 8388608,
      "use-pager": false,
      "source": {
        "paths": ["src", "tests"],
        "includes": ["vendor/symfony/http-foundation"],
        "excludes": ["src/Legacy/**", "**/*_generated.php"],
        "extensions": ["php", "php8"]
      }
    }
  ]
}
